<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>View Submissions | Pratigya Abhiyaan</title>
<style>
body {
    margin: 0;
    font-family: Arial;
    background: url('https://images.unsplash.com/photo-1711062717294-8902df8cebe3?w=900&auto=format&fit=crop&q=60') no-repeat bottom center;
    background-size: cover;
    background-attachment: fixed;
    color: white;
}

.sidebar {
    width:230px; height:100vh; position:fixed; top:0; left:0;
    background:rgba(0,0,0,0.6); padding-top:20px; backdrop-filter:blur(6px);
}
.sidebar h2 { color:#ecb613; text-align:center; margin-bottom:30px; }
.sidebar a { display:block; padding:12px; text-decoration:none; color:white; opacity:0.85; }
.sidebar a:hover, .active { background:rgba(236,182,19,0.25); color:#ecb613; }

.content { margin-left:250px; padding:30px; }

.card {
    background:rgba(255,255,255,0.08);
    padding:20px;
    border-radius:12px;
    backdrop-filter:blur(6px);
    margin-bottom:25px;
}
.card h3 { color:#ecb613; margin-top:0; }

label { font-size:14px; }

input[type="number"], textarea {
    width:100%;
    padding:10px;
    border-radius:6px;
    border:none;
    margin:8px 0 15px;
}

textarea { resize: vertical; min-height:70px; }

button {
    padding:10px;
    width:100%;
    background:#ecb613;
    border:none;
    color:black;
    font-weight:bold;
    border-radius:8px;
    cursor:pointer;
}

.file-link {
    color:#ecb613;
    text-decoration:underline;
}
</style>
</head>
<body>

<div class="sidebar">
    <h2>ðŸ“š Volunteer Panel</h2>
    <a href="volunteer_dashboard.html">Dashboard</a>
    <a href="manage_students.html"> Manage Students</a>
    <a href="upload_content.html">Upload Content</a>
    <a class="active" href="view_submissions.html">View Submissions</a>
    <a href="vprofile.html">Profile</a>
    <a href="logout.html"> Logout</a>
</div>

<div class="content">
    <h2 style="color:#ecb613;">ðŸ“„ Submitted Assignments</h2>

    <div id="submissions"></div>
</div>
</body>
<script>
async function loadSubmissions() {
    const res = await fetch("http://localhost:4000/submissions");
    const data = await res.json();

    document.getElementById("submissions").innerHTML =
        data.map(sub => `
        <div class="card">
            <h3>Assignment: ${sub.assignmentName}</h3>
            <p><b>Student:</b> ${sub.studentName}</p>

            <p><b>Submitted File:</b>
                <a class="file-link" href="http://localhost:4000/${sub.filePath}" target="_blank">View / Download</a>
            </p>

            <label>Marks:</label>
            <input type="number" id="marks-${sub._id}" value="${sub.marks ?? ""}">

            <label>Feedback:</label>
            <textarea id="feedback-${sub._id}">${sub.feedback ?? ""}</textarea>

            <button onclick="saveGrade('${sub._id}')">Save Grade</button>
        </div>
    `).join("");
}

async function saveGrade(id) {
    const marks = document.getElementById(`marks-${id}`).value;
    const feedback = document.getElementById(`feedback-${id}`).value;

    const res = await fetch("http://localhost:4000/grade-assignment", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id, marks, feedback })
    });

    const data = await res.json();
    alert(data.message);
}

loadSubmissions();
</script>



</html>
